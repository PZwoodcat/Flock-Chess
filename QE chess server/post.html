<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>Multiply via FastAPI</title>
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <style>
    body { font-family: system-ui, -apple-system, "Segoe UI", Roboto, Arial; padding: 24px; max-width: 640px; }
    label,input { display:block; margin: 6px 0; }
    button { margin-top: 12px; padding: 8px 12px; }
    pre { background:#f6f8fa; padding:12px; border-radius:6px; }
    .error { color: #b00020; }
  </style>
</head>
<body>
  <h1>Multiply (POST to /compute)</h1>

  <form id="multiplyForm">
    <label>
      a:
      <input type="number" id="a" value="2" required />
    </label>
    <label>
      b:
      <input type="number" id="b" value="3" required />
    </label>
    <button type="submit">Compute</button>
  </form>

  <h2>Result</h2>
  <div id="result"><em>no result yet</em></div>

  <h2>Raw response</h2>
  <pre id="raw">--</pre>

  <script>
    const form = document.getElementById('multiplyForm');
    const resultDiv = document.getElementById('result');
    const rawPre = document.getElementById('raw');

    // Change this if your FastAPI server is served elsewhere:
    const API_URL = 'http://127.0.0.1:8000/compute';

    form.addEventListener('submit', async (ev) => {
      ev.preventDefault();
      resultDiv.textContent = 'Computing...';
      rawPre.textContent = '--';

      const a = Number(document.getElementById('a').value);
      const b = Number(document.getElementById('b').value);

      try {
        const resp = await fetch(API_URL, {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json'
          },
          body: JSON.stringify({ a, b })
        });

        const text = await resp.text();         // keep raw text in case it's not valid json
        rawPre.textContent = text;

        if (!resp.ok) {
          resultDiv.innerHTML = `<span class="error">HTTP ${resp.status}: ${resp.statusText}</span>`;
          return;
        }

        let data;
        try {
          data = JSON.parse(text);
        } catch (e) {
          resultDiv.innerHTML = `<span class="error">Invalid JSON returned</span>`;
          return;
        }

        // Expecting {"output":"6"} (string) or {"output":6}
        const output = data.output ?? '(no output)';
        resultDiv.textContent = String(output);
      } catch (err) {
        resultDiv.innerHTML = `<span class="error">Network/Error: ${err.message}</span>`;
        rawPre.textContent = String(err);
      }
    });
  </script>
</body>
</html>
